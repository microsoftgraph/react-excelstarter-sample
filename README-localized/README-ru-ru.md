---
page_type: sample
products:
- office-excel
- office-onedrive
- ms-graph
languages:
- javascript
description: "В этом примере показано, как подключить приложение React к рабочей или учебной учетной записи Майкрософт, используя API Microsoft Graph"
extensions:
  contentType: samples
  technologies:
  - Microsoft Graph
  - Microsoft identity platform
  services:
  - Microsoft identity platform
  - Excel
  - OneDrive 
  - Users
  platforms:
  - React
  createdDate: 11/30/2017 2:43:18 PM
---
# Пример использования Microsoft Graph в Excel Starter для React

## Содержание

* [Введение](#introduction)
* [Предварительные требования](#prerequisites)
* [Регистрация приложения](#register-the-application)
* [Сборка и запуск примера](#build-and-run-the-sample)
* [Вопросы и комментарии](#questions-and-comments)
* [Участие](#contributing)
* [Дополнительные ресурсы](#additional-resources)

## Введение

В этом примере показано, как подключить приложение Angular 4.0 к рабочей или учебной учетной записи Майкрософт (Azure Active Directory), используя [API Microsoft Graph](https://developer.microsoft.com/en-us/graph/) с [пакетом SDK для JavaScript в Microsoft Graph](https://github.com/microsoftgraph/msgraph-sdk-javascript), чтобы получить сведения о пользователе, выполнившем вход, и отправить эти сведения в файл Excel, хранящийся в OneDrive.

![изображение](https://user-images.githubusercontent.com/3375461/28985978-e5d3ea26-7919-11e7-8a69-a52bccd3f46b.png)

После проверки подлинности и авторизации приложение получает имя и адрес электронной почты пользователя, выполнившего вход.

![изображение](readme-images/ReactScreenShot.png)

При нажатии кнопки **Запись в Excel** приложение записывает сведения о пользователе в файл Excel, хранящийся в корневой папке OneDrive пользователя.

![изображение](readme-images/ExcelScreenShot.png)

## Предварительные требования

Для использования этого примера необходимы следующие компоненты:
* [Node.js](https://nodejs.org/). Платформа Node необходима для установки зависимостей и запуска примера на сервере разработки.
* [Microsoft account](https://www.outlook.com)
* [Учетная запись Office 365 для бизнеса](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment#bk_Office365Account)* Отправьте файл **demo.xlsx**, находящийся в корневой папке этого репозитория, в корневую папку вашей учетной записи OneDrive. Этот файл содержит пустую таблицу с двумя столбцами.

## Регистрация приложения

1. Войдите на [Портал Azure — Регистрация приложений](https://go.microsoft.com/fwlink/?linkid=2083908) с помощью личной, рабочей или учебной учетной записи.

2. Выберите **Новая регистрация**.

3. В разделе **Имя** введите понятное имя приложения, которое будет отображаться для пользователей приложения

1. В разделе **Поддерживаемые типы учетных записей** выберите **Учетные записи в любом каталоге организации и личные учетные записи Майкрософт (например, Skype, Xbox, Outlook.com)**  

1. Выберите **Зарегистрировать**, чтобы создать приложение. 
	
   На странице приложения "Обзор" приводятся свойства приложения.

4. Скопируйте **идентификатор приложения (клиента)**. Это уникальный идентификатор приложения. 

5. В списке страниц приложения выберите **Проверка подлинности**.

6. В разделе **Redirect URIs** из раскрывающегося списка **Тип** выберите **Интернет** и введите *http://localhost:3000/* в качестве **URI перенаправления**. 

1. В разделе **Дополнительные параметры** включите последовательность операций неявного предоставления разрешений, установив флажки **Маркеры доступа** и **Маркеры ИД** 

8. Выберите команду **Сохранить**.

## Сборка и запуск примера

1. Используя свою любимую среду IDE, откройте **configs.ts** в *src/*.

2. Замените текст **ENTER_YOUR_CLIENT_ID** на идентификатор зарегистрированного приложения Azure.

3. Откройте командную строку и выполните приведенную ниже команду в корневом каталоге: `npm install`.
  
4. Выполните команду `npm start`, чтобы запустить сервер разработки.

5. Введите адрес [http://localhost:3000/](http://localhost:3000/) в веб-браузере.

6. Нажмите кнопку **Вход с помощью учетной записи Майкрософт**.

7. Войдите с помощью личной, рабочей или учебной учетной записи и предоставьте необходимые разрешения.

8. Нажмите кнопку **Запись в Excel**. Убедитесь, что в файл **demo.xslx**, который вы отправили в корневую папку OneDrive, добавлены строки.


## Участие

Если вы хотите добавить код в этот пример, просмотрите статью [CONTRIBUTING.MD](/CONTRIBUTING.md).

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## Вопросы и комментарии

Мы будем рады узнать ваше мнение об этом примере. Вы можете отправлять нам свои вопросы и предложения с помощью вкладки [Проблемы](https://github.com/microsoftgraph/react-excelstarter-sample/issues) этого репозитория.

Общие вопросы о разработке решений для Microsoft Graph следует задавать на сайте [Stack Overflow](https://stackoverflow.com/questions/tagged/microsoftgraph). Обязательно помечайте свои вопросы и комментарии тегом [microsoftgraph].
  
## Дополнительные ресурсы

- [Другие примеры приложений, подключающихся с использованием Microsoft Graph](https://github.com/MicrosoftGraph?utf8=%E2%9C%93&query=-Connect)
- [Microsoft Graph](https://developer.microsoft.com/en-us/graph/)

## Авторские права
(c) Корпорация Майкрософт (Microsoft Corporation), 2017. Все права защищены.
